<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BP Registration</title>
<style>
body { font-family: Arial,sans-serif; background:#f6f8fa; display:flex; justify-content:center; padding:24px;}
.card { max-width:720px; width:100%; background:#fff; padding:20px; border-radius:12px; box-shadow:0 6px 24px rgba(18,38,63,0.08);}
h1 { margin:0 0 8px;}
p.lead { margin:0 0 18px; color:#666;}
label { display:block; margin-top:12px; font-weight:600;}
input { width:100%; padding:10px; margin-top:6px; border:1px solid #e3e8ee; border-radius:8px; box-sizing:border-box;}
button { margin-top:16px; padding:10px 16px; border-radius:8px; border:0; background:#0b76ef; color:#fff; font-weight:600; cursor:pointer;}
button[disabled] { opacity:0.6; cursor:not-allowed;}
.msg { margin-top:14px; font-weight:600;}
.msg.ok { color:green;}
.msg.err { color:#c0392b;}
small.hint { display:block; margin-top:10px; color:#666;}
</style>
</head>
<body>

<div class="card">
<h1>BP Registration</h1>
<p class="lead">BP NAME, OUTLATE NAME, AREA, DESIGNATION, BP ID দিয়ে রেজিস্ট্রেশন করুন।</p>

<form id="regForm" autocomplete="off">
<label>BP NAME
<input id="bpField" name="bpName" type="text" required>
</label>

<label>OUTLATE NAME
<input id="outField" name="outletName" type="text" required>
</label>

<label>AREA
<input id="areaField" name="area" type="text" required>
</label>

<label>DESIGNATION
<input id="desField" name="designation" type="text" required>
</label>

<label>BP ID
<input id="bpIdField" name="bpId" type="text" required>
</label>

<label>PASSWORD
<input id="passField" name="password" type="password" required minlength="6">
</label>

<button id="submitBtn" type="submit">Register</button>
<div id="msg" class="msg"></div>
<small class="hint">সাবমিশনের পরে মেসেজ একই পেইজে দেখা যাবে।</small>
</form>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbys8u_uOL3yqfth0vCXSmoy-lKzJAUO-GtIZAL1E3acV4zCm-QAdEnJA-s-2ynIfEwE/exec";

const form = document.getElementById('regForm');
const submitBtn = document.getElementById('submitBtn');
const msgEl = document.getElementById('msg');

function setMessage(text, ok=true){
  msgEl.textContent = text;
  msgEl.className = ok ? 'msg ok' : 'msg err';
}

function validate(data){
  if(!data.bpName) return "BP Name is required";
  if(!data.outletName) return "Outlet Name is required";
  if(!data.area) return "Area is required";
  if(!data.designation) return "Designation is required";
  if(!data.bpId) return "BP ID is required";
  if(!data.password || data.password.length<6) return "Password must be at least 6 characters";
  return null;
}

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  setMessage('', true);

  const payload = {
    bpName: document.getElementById('bpField').value.trim(),
    outletName: document.getElementById('outField').value.trim(),
    area: document.getElementById('areaField').value.trim(),
    designation: document.getElementById('desField').value.trim(),
    bpId: document.getElementById('bpIdField').value.trim(),
    password: document.getElementById('passField').value
  };

  const vErr = validate(payload);
  if(vErr){ setMessage(vErr,false); return; }

  submitBtn.disabled = true;
  submitBtn.textContent = "Submitting...";

  try{
    const res = await fetch(API_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    const text = await res.text(); // HtmlService returns text
    const json = JSON.parse(text);

    if(json.status==='success'){
      setMessage(json.message,true);
      form.reset();
    } else if(json.status==='exists'){
      setMessage(json.message,false);
    } else {
      setMessage(json.message||"Server error",false);
    }

  } catch(err){
    setMessage('Network error: '+err.message,false);
  } finally {
    submitBtn.disabled = false;
    submitBtn.textContent = "Register";
  }
});
</script>

</body>
</html>
